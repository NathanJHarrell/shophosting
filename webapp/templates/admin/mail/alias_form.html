{% extends "admin/base_admin.html" %}

{% block title %}Create Alias{% endblock %}
{% block page_title %}Create Alias{% endblock %}

{% block content %}
<div style="max-width: 600px;">
    <a href="{{ url_for('admin.mail_aliases') }}" class="btn btn-secondary btn-sm mb-4">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
        Back to Aliases
    </a>

    <div class="card">
        <div class="card-header">
            <h3 class="card-title">New Alias</h3>
        </div>
        <div class="card-body">
            <form method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                <div class="form-group">
                    <label for="alias_username">Alias Address *</label>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <input type="text" id="alias_username" name="alias_username" class="form-control" required
                               placeholder="alias" style="flex: 1;">
                        <span style="color: var(--text-secondary); font-size: 1.1rem;">@</span>
                        <select id="domain" name="domain" class="form-control" required style="flex: 1;">
                            {% for domain in domains %}
                            <option value="{{ domain }}">{{ domain }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <p class="text-muted" style="font-size: 0.85rem; margin-top: 6px;">
                        Emails sent to this address will be forwarded to the destination mailbox.
                    </p>
                </div>

                <div class="form-group">
                    <label for="destination_mailbox">Destination Mailbox *</label>
                    <select id="destination_mailbox" name="destination_mailbox" class="form-control" required>
                        <option value="">Select a mailbox...</option>
                        {% for mailbox in mailboxes %}
                        <option value="{{ mailbox.id }}" {% if preselected_destination == mailbox.email %}selected{% endif %}>{{ mailbox.email }}</option>
                        {% endfor %}
                    </select>
                    <p class="text-muted" style="font-size: 0.85rem; margin-top: 6px;">
                        The mailbox that will receive emails sent to the alias.
                    </p>
                </div>

                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" name="is_active" checked style="width: 18px; height: 18px;">
                        <span>Active</span>
                    </label>
                    <p class="text-muted" style="font-size: 0.85rem; margin-top: 6px;">
                        Disabled aliases will not forward emails.
                    </p>
                </div>

                <div style="display: flex; gap: 12px; margin-top: 24px;">
                    <button type="submit" class="btn btn-primary">Create Alias</button>
                    <a href="{{ url_for('admin.mail_aliases') }}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
